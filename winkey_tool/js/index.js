import{c as C}from"../assets/react-dom.865344de.js";import{B as L}from"../assets/react-router-dom.877736a7.js";import{r as i,a as B}from"../assets/react.03cc10e8.js";import{a as S}from"../assets/axios.a2f4dec8.js";import{a as p,j as l,u as O}from"../assets/react-router.35a75e22.js";import"../assets/scheduler.065d6083.js";import"../assets/@remix-run.5f363a48.js";function G(){import("data:text/javascript,")}(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))a(e);new MutationObserver(e=>{for(const r of e)if(r.type==="childList")for(const c of r.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&a(c)}).observe(document,{childList:!0,subtree:!0});function u(e){const r={};return e.integrity&&(r.integrity=e.integrity),e.referrerpolicy&&(r.referrerPolicy=e.referrerpolicy),e.crossorigin==="use-credentials"?r.credentials="include":e.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function a(e){if(e.ep)return;e.ep=!0;const r=u(e);fetch(e.href,r)}})();const f=S.create({baseURL:"/",timeout:5e3});f.interceptors.request.use(t=>t,function(t){return Promise.reject(t)});f.interceptors.response.use(t=>t.data,function(t){return Promise.reject(t)});const R=()=>f.get("http://127.0.0.1:10110/getLocalFolder"),j=t=>f.get(`http://127.0.0.1:10110/getLocalFileDetail?path=${t}`),D=t=>f.post("http://127.0.0.1:10110/submitFile",{...t});var y=(t=>(t[t.Folder=0]="Folder",t[t.File=1]="File",t))(y||{});const T="index-module__ricar_tool___1x5y3",H="index-module__logo___7VnZf",K="index-module__fileBox___I4tNa",M="index-module__showFileBox___X76CE",P="index-module__left___OhNNT",V="index-module__right___Ld2-J",$="index-module__textEditor___kfRT1",W="index-module__hidden___j9xoP",s={ricar_tool:T,logo:H,fileBox:K,showFileBox:M,left:P,right:V,textEditor:$,"wk-tree-treenode":"index-module__wk-tree-treenode___8g9WV","wk-tree-indent":"index-module__wk-tree-indent___SnrI-","wk-tree-indent-unit":"index-module__wk-tree-indent-unit___eRyRw","wk-tree-switcher":"index-module__wk-tree-switcher___FWCOk","wk-tree-switcher-icon":"index-module__wk-tree-switcher-icon___01k5V","wk-tree-switcher-noop":"index-module__wk-tree-switcher-noop___B38ND","wk-tree-switcher_open":"index-module__wk-tree-switcher_open___Q3blq","wk-tree-node-content-wrapper":"index-module__wk-tree-node-content-wrapper___Z4NHS","wk-tree-node-content-wrapper-editor":"index-module__wk-tree-node-content-wrapper-editor___54fVD",hidden:W},q=t=>{const{visible:n}=t,[u,a]=i.exports.useState([]),[e,r]=i.exports.useState(null),[c,m]=i.exports.useState({}),[w,h]=i.exports.useState(!1),_=o=>{o.expanded=!o.expanded,a(Object.assign([],u))},x=async o=>{o.type===1&&r(o)},F=o=>{e&&(e.editor=!0,a(Object.assign([],u)),c[e==null?void 0:e.path]=o.currentTarget.value,m(Object.assign({},c)))},N=i.exports.useMemo(()=>{const o=(k,g)=>k.map((d,v)=>p(B.Fragment,{children:[p("div",{className:s["wk-tree-treenode"],children:[l("span",{className:s["wk-tree-indent"],children:new Array(g).fill(0).map((X,b)=>l("span",{className:s["wk-tree-indent-unit"]},`wk-tree-indent_${b}_${g}`))}),l("span",{className:s["wk-tree-switcher"]+(d.children&&d.children.length!==0?"":" "+s["wk-tree-switcher-noop"])+(d.expanded?" "+s["wk-tree-switcher_open"]:""),onClick:()=>_(d),children:d.children&&d.children.length!==0&&l("i",{className:s["wk-tree-switcher-icon"]})}),p("span",{className:s["wk-tree-node-content-wrapper"],onDoubleClick:()=>x(d),children:[l("span",{children:d.name}),d.editor&&l("i",{className:s["wk-tree-node-content-wrapper-editor"]})]})]}),d.type===y.Folder&&d.expanded&&o(d.children,g+1)]},`wk_tree_${v}_${g}`));return o(u,0)},[u]),E=i.exports.useCallback(async()=>{const o=await R();o.success===0?(o.data.map(k=>k.expanded=!1),a(Object.assign([],o.data))):a([])},[]);return i.exports.useEffect(()=>{n&&E()},[n]),i.exports.useEffect(()=>{e&&j(e.path).then(o=>{o.success===0&&(c[e.path]=JSON.parse(o.data),m(Object.assign({},c)))})},[e]),i.exports.useEffect(()=>{w?document.onkeydown=o=>{if((o.keyCode||o.which||o.charCode)===83&&(o.ctrlKey||o.metaKey))return o.preventDefault(),D({content:c[e==null?void 0:e.path],path:e==null?void 0:e.path}),!1}:document.onkeydown=null},[w,c]),p("div",{className:s.fileBox+(n?"":" "+s.hidden),children:[l("div",{className:s.left,children:N}),l("div",{className:s.right,onMouseEnter:()=>h(!0),onMouseLeave:()=>h(!1),children:e&&l("textarea",{wrap:"off",className:s.textEditor,value:c[e==null?void 0:e.path]||"",onChange:F})})]})},A="/winkey_tool/images/logo.png",J=()=>{const t=i.exports.useRef(null),n=i.exports.useRef(),[u,a]=i.exports.useState(document.documentElement.clientHeight-80),[e,r]=i.exports.useState(document.documentElement.clientWidth-80),[c,m]=i.exports.useState(!1),w=()=>{n.current||(n.current=setTimeout(()=>{clearTimeout(n.current),n.current=null,window.onmousemove=_=>{a(_.y-25),r(_.x-27.5),window.onmouseup=()=>{window.onmousemove=null,window.onmouseup=null}}},1e3),window.onmouseup=()=>{clearTimeout(n.current),n.current=null,window.onmousemove=null,window.onmouseup=null})},h=()=>{clearTimeout(n.current),n.current=null,m(!0)};return i.exports.useEffect(()=>{window.addEventListener("resize",()=>{a(document.documentElement.clientHeight-80),r(document.documentElement.clientWidth-80)},!1)},[]),i.exports.useEffect(()=>{c&&(window.onclick=_=>{var x;!((x=t.current)!=null&&x.contains(_.target))&&t.current!==_.target&&(m(!1),window.onclick=null)})},[c]),p("div",{ref:t,className:s.ricar_tool,style:{top:u,left:e},onMouseDown:w,onDoubleClick:h,children:[l(q,{visible:c}),l("img",{className:s.logo,src:A})]})},Z=()=>l(J,{});const z=[{path:"/",name:"\u4E3B\u9875",element:l(Z,{})}],Q=()=>O(z),U=C.createRoot(document.getElementById("winkey_tool"));U.render(l(L,{children:l(Q,{})}));export{G as __vite_legacy_guard};
